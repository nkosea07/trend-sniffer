<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trend Sniffer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="grain"></div>
    <div class="orb orb-a"></div>
    <div class="orb orb-b"></div>
    <main class="shell">
      <header class="hero card">
        <p class="eyebrow">Live Industry Intelligence</p>
        <h1>Trend Sniffer</h1>
        <p class="tagline">
          A structured intelligence board for tracking fresh technology trends, common Google searches, product opportunities, and actionable alerts.
        </p>
        <div class="hero-actions">
          <button id="refreshBtn" class="btn btn-primary">Refresh Live Signals</button>
          <label class="search">
            <span>Filter</span>
            <input id="searchInput" type="search" placeholder="Search trend, topic, source, challenge..." />
          </label>
        </div>
        <div id="stats" class="stats"></div>
        <div class="mini-grid">
          <div class="card mini-card">
            <h3>Pulse Meter</h3>
            <p id="pendingStrip">Checking pending items...</p>
          </div>
          <div class="card mini-card">
            <h3>Idea Spark</h3>
            <p id="sparkText">Loading spark...</p>
          </div>
          <div class="card mini-card">
            <h3>Topic Mix</h3>
            <div id="sourceMix" class="mix-list"></div>
          </div>
        </div>
      </header>

      <section class="panel-nav card">
        <button class="tab-btn active" data-tab="signals">Top Signals</button>
        <button class="tab-btn" data-tab="searches">Google Searches</button>
        <button class="tab-btn" data-tab="videos">Video Radar</button>
        <button class="tab-btn" data-tab="challenges">Build Opportunities</button>
        <button class="tab-btn" data-tab="alerts">Alerts</button>
        <button class="tab-btn" data-tab="watchlist">Watchlist Studio</button>
        <button class="tab-btn" data-tab="copilot">Copilot</button>
      </section>

      <section class="content-stack">
        <article class="tab-panel active" data-panel="signals">
          <div class="section-head">
            <h2>Fresh Tech Signals</h2>
            <p>Curated from multiple live sources with direct references.</p>
          </div>
          <div id="signalsGrid" class="grid"></div>
        </article>

        <article class="tab-panel" data-panel="searches">
          <div class="section-head">
            <h2>Most Common Recent Google Searches</h2>
            <p>Live daily trending queries in the US from Google Trends RSS.</p>
          </div>
          <div id="searchesGrid" class="grid"></div>
        </article>

        <article class="tab-panel" data-panel="videos">
          <div class="section-head">
            <h2>Video Radar</h2>
            <p>Track key releases and explainers from major technology channels.</p>
          </div>
          <div id="videosGrid" class="grid"></div>
        </article>

        <article class="tab-panel" data-panel="challenges">
          <div class="section-head">
            <h2>Current Developer Challenges</h2>
            <p>Recurring pain points with product ideas and monetization paths.</p>
            <button id="sparkBtn" class="btn">Generate New Spark</button>
          </div>
          <div id="challengesGrid" class="grid"></div>
          <div class="section-head slim">
            <h3>Evidence Feed</h3>
            <p>Recent high-signal questions linked for verification.</p>
          </div>
          <div id="evidenceGrid" class="grid"></div>
        </article>

        <article class="tab-panel" data-panel="alerts">
          <div class="section-head">
            <h2>Telegram Alerts</h2>
            <p>Push alerts only when new items appear, with optional full digest override.</p>
          </div>
          <div class="alerts-layout">
            <div class="card inner-card">
              <h3>Digest Delivery</h3>
              <label class="search block">
                <span>Template</span>
                <select id="alertTemplateSelect"></select>
              </label>
              <div class="button-row">
                <button id="sendDigestBtn" class="btn btn-primary">Send New-Items Alert</button>
                <button id="sendFullDigestBtn" class="btn">Send Full Digest</button>
              </div>
              <div class="button-row">
                <button id="previewDigestBtn" class="btn">Preview Digest</button>
                <button id="acknowledgeBtn" class="btn">Mark Current Feed Seen</button>
              </div>
              <p id="alertStatus" class="hint">Ready.</p>
            </div>
            <div class="card inner-card">
              <h3>Digest Preview</h3>
              <pre id="previewOutput" class="preview">No preview yet.</pre>
            </div>
            <div class="card inner-card references">
              <h3>Sources Used</h3>
              <ul id="sourcesList"></ul>
              <p class="hint">Every card links back to its source for direct verification.</p>
            </div>
            <div class="card inner-card">
              <h3>Custom Message</h3>
              <label class="search block">
                <span>Message</span>
                <textarea id="customMessage" rows="4" placeholder="Drop a note to your channel..."></textarea>
              </label>
              <button id="sendMessageBtn" class="btn">Send Message</button>
            </div>
          </div>
        </article>

        <article class="tab-panel" data-panel="watchlist">
          <div class="section-head">
            <h2>Watchlist Studio</h2>
            <p>Persist your topics, saved channels, and custom digest templates.</p>
          </div>
          <div class="studio-grid">
            <div class="card inner-card">
              <h3>Saved Topics</h3>
              <div class="chip-wrap" id="watchTopicsList"></div>
              <div class="inline-form">
                <input id="topicInput" type="text" placeholder="e.g. edge ai" />
                <button id="addTopicBtn" class="btn">Add Topic</button>
              </div>
            </div>
            <div class="card inner-card">
              <h3>Saved Channels</h3>
              <div class="chip-wrap" id="watchChannelsList"></div>
              <div class="inline-form stacked">
                <input id="channelLabelInput" type="text" placeholder="Channel label (required)" />
                <input id="channelIdInput" type="text" placeholder="YouTube channel ID (optional, for ingest)" />
                <button id="addChannelBtn" class="btn">Add Channel</button>
              </div>
            </div>
            <div class="card inner-card full-width">
              <h3>Custom Digest Templates</h3>
              <label class="search block">
                <span>Templates</span>
                <select id="templateSelect"></select>
              </label>
              <div class="inline-form stacked">
                <input id="templateNameInput" type="text" placeholder="Template name" />
                <textarea id="templateBodyInput" rows="9" placeholder="Use placeholders like {{generatedAt}}, {{signalsList}}, {{searchesList}}, {{videosList}}, {{watchTopics}}, {{sparkLine}}"></textarea>
              </div>
              <div class="button-row">
                <button id="newTemplateBtn" class="btn">New Template</button>
                <button id="saveTemplateBtn" class="btn btn-primary">Save Template</button>
                <button id="deleteTemplateBtn" class="btn">Delete Template</button>
                <button id="activateTemplateBtn" class="btn">Set Active</button>
              </div>
              <p id="studioStatus" class="hint">Template changes are persisted locally.</p>
            </div>
          </div>
        </article>

        <article class="tab-panel" data-panel="copilot">
          <div class="section-head">
            <h2>Copilot</h2>
            <p>Local assistant, manual RSS control, and confirmation-first actions.</p>
          </div>
          <div class="copilot-grid">
            <div class="card inner-card">
              <h3>Ask Copilot</h3>
              <label class="search block">
                <span>Prompt</span>
                <textarea id="copilotInput" rows="4" placeholder="Try: What's new, pause telegram, add source https://..."></textarea>
              </label>
              <button id="copilotAskBtn" class="btn btn-primary">Ask Copilot</button>
              <pre id="copilotOutput" class="preview">Copilot is ready.</pre>
            </div>
            <div class="card inner-card">
              <div class="section-head slim">
                <h3>Pending Confirmations</h3>
                <button id="refreshActionsBtn" class="btn">Refresh Queue</button>
              </div>
              <div id="copilotActionsList" class="action-list"></div>
            </div>
            <div class="card inner-card">
              <h3>RSS Sources (Simple Mode)</h3>
              <div class="button-row">
                <button id="applyBusinessMakerPresetBtn" class="btn">Apply Business + Maker</button>
                <button id="applyTechPresetBtn" class="btn">Apply Technology Core</button>
              </div>
              <div class="inline-form stacked">
                <input id="rssNameInput" type="text" placeholder="Source name (required)" />
                <input id="rssUrlInput" type="url" placeholder="RSS URL (required)" />
                <input id="rssCategoryInput" type="text" placeholder="Category (e.g. Design, Finance, Sport)" />
                <button id="addRssBtn" class="btn">Queue Add Source</button>
              </div>
              <div id="rssSourcesList" class="source-list"></div>
            </div>
            <div class="card inner-card">
              <h3>Daily Briefing Settings</h3>
              <div class="inline-form stacked">
                <label class="search block">
                  <span>Time</span>
                  <input id="briefingTimeInput" type="time" value="06:30" />
                </label>
                <label class="search block">
                  <span>Timezone</span>
                  <input id="briefingTimezoneInput" type="text" value="Africa/Johannesburg" />
                </label>
                <label class="toggle">
                  <input id="briefingInAppInput" type="checkbox" checked />
                  <span>Generate in-app briefing</span>
                </label>
                <label class="toggle">
                  <input id="briefingTelegramInput" type="checkbox" checked />
                  <span>Enable telegram delivery</span>
                </label>
                <label class="toggle">
                  <input id="briefingTelegramPausedInput" type="checkbox" />
                  <span>Pause telegram summary sending</span>
                </label>
              </div>
              <div class="button-row">
                <button id="saveBriefingSettingsBtn" class="btn">Queue Settings Update</button>
                <button id="generateBriefingBtn" class="btn btn-primary">Generate Briefing Now</button>
              </div>
              <p id="copilotStatus" class="hint">All config is stored locally in data/trend-sniffer-store.json.</p>
            </div>
          </div>
        </article>
      </section>

      <footer class="foot card">
        <div>
          <strong>Trend Sniffer</strong>
          <p id="timestamp">Waiting for first sync...</p>
        </div>
        <p id="telegramStatus" class="pill">Checking Telegram status...</p>
      </footer>
    </main>

    <template id="loadingTemplate">
      <div class="card loading">Loading live data...</div>
    </template>

    <script src="./app.js" defer></script>
  </body>
</html>
